pipeline {
  agent {
    kubernetes {
      yamlFile ".ngci/agent-pod.yaml"
    }
  }

  options {
    timestamps()
    buildDiscarder(logRotator(numToKeepStr: "10", artifactNumToKeepStr: "10"))
  }

  environment {
    NGCI_VERSION = "5.0"
  }

  parameters {
    string(name: "JSON_FILE", description: "JSON file path", defaultValue: ".ngci/ngci.json")
  }

  stages {
    stage("Init") {
      steps {
        script {
          library changelog: false, identifier: "ngci@${NGCI_VERSION}"
          LoadNGCI()
        }
      }
    }
  }
}
